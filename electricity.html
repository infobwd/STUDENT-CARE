<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>สารสนเทศเยี่ยมบ้านนักเรียน</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css" />
    <link href="https://fonts.googleapis.com/css2?family=Prompt&family=Google+Sans:wght@400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/remixicon/4.2.0/remixicon.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.2/css/all.min.css" integrity="sha512-1sCRPdkRXhBV2PBLUdRb4tMg1w2YPf37qatUFeS7zlBy7jJI8Lf4VHwWfZZfpXtYSLy85pkm9GaYVYMfw5BC1A==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link href="https://cdn.datatables.net/1.13.7/css/dataTables.bootstrap5.min.css" rel="stylesheet">
    <link href="https://cdn.datatables.net/responsive/2.5.0/css/responsive.bootstrap5.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-table@1.20.0/dist/bootstrap-table.min.css">
    <link rel="stylesheet" href="https://cdn.datatables.net/buttons/2.3.6/css/buttons.bootstrap5.min.css">
    <link rel="stylesheet" href="styles.css">
    <link rel="icon" href="https://raw.githubusercontent.com/infobwd/STUDENT-CARE/main/icons8-information-96.png" type="image/x-icon"> <!-- Update with the path to your favicon -->
    <script src="https://cdn.lordicon.com/lordicon.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bodymovin/5.7.13/lottie.min.js"></script>
</head>
<body style="font-family: 'Google Sans', sans-serif;">
<!-- Nav Section -->
<nav class="navbar navbar-expand-lg navbar-custom">
    <div class="container">
        <a class="navbar-brand" href="https://infobwd.github.io/STUDENT-CARE">
            <img src="https://raw.githubusercontent.com/infobwd/STUDENT-CARE/main/icons8-information-96.png" alt="Logo" width="30" height="30" class="d-inline-block align-top"> สารสนเทศเยี่ยมบ้านนักเรียน
        </a>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNavDropdown" aria-controls="navbarNavDropdown" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarNavDropdown">
            <ul class="navbar-nav me-auto">
                <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle" href="#" id="navbarDropdownMenuLink" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                        เมนู
                    </a>
                     <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="navbarDropdownMenuLink">
                            <li><a class="dropdown-item" href="index.html"><i class="fas fa-house-user"></i> ข้อมูลเยี่ยมบ้าน และ สถานะครอบครัว</a></li>
                            <li><a class="dropdown-item" href="residence.html"><i class="fas fa-home"></i> ข้อมูลการอยู่อาศัย</a></li>
                            <li><a class="dropdown-item" href="floorMaterial.html"><i class="fas fa-hammer"></i> วัสดุที่ใช้ทำบ้าน</a></li>
                            <li><a class="dropdown-item" href="electricity.html"><i class="fas fa-lightbulb"></i> แหล่งน้ำดื่ม|แหล่งไฟฟ้า</a></li>
                            <li><a class="dropdown-item" href="land.html"><i class="fas fa-tractor"></i> ที่ดินทำการเกษตร และ ยานพาหนะ</a></li>
                            <li><a class="dropdown-item" href="occupations.html"><i class="fas fa-briefcase"></i> อาชีพผู้ปกครองและรายได้</a></li>
                            <li><a class="dropdown-item" href="map.html"><i class="fas fa-map-marked-alt"></i> แผนที่เยี่ยมบ้าน</a></li>
                    </ul>
                </li>
            </ul>
            <form class="d-flex flex-fill" role="search" action="search.html" method="get">
                <input class="form-control me-2" type="text" inputmode="numeric" pattern="[0-9]*" placeholder="ค้นหาโดยรหัสนักเรียน" aria-label="Search" id="studentIdSearch" name="studentId">
                <button class="btn btn-outline-light me-2" type="submit">ค้นหา</button>
            </form>
            <button id="fullscreenButton" class="btn btn-outline-light me-2">ขยายเต็มจอ</button>
            <button id="fontSizeButton" class="btn btn-outline-light me-2">ก</button>
            <button id="login-button" class="btn btn-primary"><i class="fab fa-line"></i> LINE Login</button>
        </div>
    </div>
</nav>
<br>
<div id="content-section" class="container mt-5" style="margin-top: 70px;">
    <div class="d-flex flex-column flex-md-row justify-content-between align-items-md-center mb-3">
        <div class="text-start order-2 order-md-1">
            <span id="currentDateTime" class="currentDateTime"></span>
        </div>
        <div class="text-end order-1 order-md-2">
            <img id="profile-picture" src="" alt="Profile Picture" class="rounded-circle" width="50" height="50" style="display: none;">
            <span id="profile-name" class="ms-2"></span>
            <button id="logout-button" class="btn btn-secondary ms-2" style="display: none;">Logout</button>
            <button id="share-button" class="btn btn-success ms-2" style="display: none;"><i class="fab fa-line"></i> Share</button>
        </div>
    </div>
    <h2>เลือกภาคเรียนที่</h2>
    <select id="semesterDropdown" class="form-control mb-4"></select>
<!-- ข้อมูลแหล่งไฟฟ้า -->
    <h2>แหล่งไฟฟ้า</h2>
    <ul class="box-info">
    <li>
        <img src="https://cdn-icons-png.flaticon.com/512/678/678610.png" style="width: 80px; height: 80px;" alt="ไม่มีไฟฟ้า">
        <span class="text">
            <p>ไม่มีไฟฟ้า</p>
            <h3 id="electricityDataA">0 <span style="font-size: 12px">(คน)</span></h3>
            <p><span id="electricityPercentA">0%</span></p>
        </span>
    </li>
    <li>
        <img src="https://cdn-icons-png.flaticon.com/512/10667/10667780.png" style="width: 80px; height: 80px;" alt="มีไฟฟ้า">
        <span class="text">
            <p>มีไฟฟ้า</p>
            <h3 id="electricityDataB">0 <span style="font-size: 12px">(คน)</span></h3>
            <p><span id="electricityPercentB">0%</span></p>
        </span>
    </li>
    <li>
        <img src="https://cdn-icons-png.flaticon.com/512/3574/3574211.png" style="width: 80px; height: 80px;" alt="ไฟบ้านหรือมิเตอร์">
        <span class="text">
            <p>ไฟบ้านหรือมิเตอร์</p>
            <h3 id="electricityDataC">0 <span style="font-size: 12px">(คน)</span></h3>
            <p><span id="electricityPercentC">0%</span></p>
        </span>
    </li>
    <li>
        <img src="https://cdn-icons-png.flaticon.com/512/7299/7299462.png" style="width: 80px; height: 80px;" alt="เครื่องปั่นไฟ/โซลาเซลล์">
        <span class="text">
            <p>เครื่องปั่นไฟ/โซลาเซลล์</p>
            <h3 id="electricityDataD">0 <span style="font-size: 12px">(คน)</span></h3>
            <p><span id="electricityPercentD">0%</span></p>
        </span>
    </li>
    <li>
        <img src="https://cdn-icons-png.flaticon.com/512/1687/1687413.png" style="width: 80px; height: 80px;" alt="ไฟต่อพ่วง/แบตเตอรี่">
        <span class="text">
            <p>ไฟต่อพ่วง/แบตเตอรี่</p>
            <h3 id="electricityDataE">0 <span style="font-size: 12px">(คน)</span></h3>
            <p><span id="electricityPercentE">0%</span></p>
        </span>
    </li>
</ul>

  <!-- จบข้อมูลแหล่งไฟฟ้า -->

    <!-- ข้อมูลแหล่งน้ำ-->
    <h2>แหล่งน้ำดื่ม</h2>
<ul class="box-info">
    <li>
        <img src="https://cdn-icons-png.flaticon.com/512/8118/8118961.png" style="width: 80px; height: 80px;" alt="น้ำดื่มบรรจุขวด/ ตู้หยอดน้ำ">
        <span class="text">
            <p>น้ำดื่มบรรจุขวด/ ตู้หยอดน้ำ</p>
            <h3 id="waterDataA">0 <span style="font-size: 12px">(คน)</span></h3>
            <p><span id="waterPercentA">0%</span></p>
        </span>
    </li>
    <li>
        <img src="https://cdn-icons-png.flaticon.com/512/1683/1683015.png" style="width: 80px; height: 80px;" alt="น้ำประปา">
        <span class="text">
            <p>น้ำประปา</p>
            <h3 id="waterDataB">0 <span style="font-size: 12px">(คน)</span></h3>
            <p><span id="waterPercentB">0%</span></p>
            </span>
        </li>
        <li>
        <img src="https://cdn-icons-png.flaticon.com/512/16437/16437822.png" style="width: 80px; height: 80px;" alt="น้ำบ่อ/น้ำบาดาล">
        <span class="text">
            <p>น้ำบ่อ/น้ำบาดาล</p>
            <h3 id="waterDataC">0 <span style="font-size: 12px">(คน)</span></h3>
            <p><span id="waterPercentC">0%</span></p>
        </span>
    </li>
        <li>
            <img src="https://cdn-icons-png.flaticon.com/512/1959/1959317.png" style="width: 80px; height: 80px;" alt="หอพัก">
            <span class="text">
                <p>น้ำฝน/น้ำประปาภูเขา/ลำธาร</p>
                <h3 id="waterDataD">0 <span style="font-size: 12px">(คน)</span></h3>
                <p><span id="waterPercentD">0%</span></p>
            </span>
        </li>
    </ul>
    <!-- จบแหล่งน้ำ-->
    

    <div class="mb-3 marquee">
        <div><span id="newsTicker"></span></div>
        <a href="news.html" class="news-button">อ่านข่าวทั้งหมด</a>
    </div>
</div>
<br>
<!-- Footer Section -->
<div id="footer-container"></div>
<!-- Chat Button -->
<button onclick="chatFunction()" id="chatBtn" title="Chat with us"><i class="fa fa-comments"></i></button>
<!-- Search Popup Modal -->
<div class="modal fade" id="searchModal" tabindex="-1" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="searchModalLabel">Search</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <p>ค้นหานักเรียนรหัส: <span id="searchedStudentId"></span></p>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                <button type="button" class="btn btn-primary">Search</button>
            </div>
        </div>
    </div>
</div>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
<script src="https://cdn.datatables.net/1.13.7/js/jquery.dataTables.min.js"></script>
<script src="https://cdn.datatables.net/1.13.7/js/dataTables.bootstrap5.min.js"></script>
<script src="https://cdn.datatables.net/responsive/2.5.0/js/dataTables.responsive.min.js"></script>
<script src="https://cdn.datatables.net/responsive/2.5.0/js/responsive.bootstrap5.min.js"></script>
<script src="https://cdn.datatables.net/buttons/2.3.6/js/dataTables.buttons.min.js"></script>
<script src="https://cdn.datatables.net/buttons/2.3.6/js/buttons.bootstrap5.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.1.3/jszip.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.36/pdfmake.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.36/vfs_fonts.js"></script>
<script src="script.js"></script>
<script>
      document.addEventListener('DOMContentLoaded', function() {
        populateDropdown();

        document.getElementById('semesterDropdown').addEventListener('change', function() {
            const selectedSemester = this.value;
            loadElectricityData(selectedSemester);
            loadWaterData(selectedSemester);
        });

        document.addEventListener('click', function (e) {
            if (!e.target.closest('.navbar-nav') && !e.target.closest('#studentIdSearch')) {
                var navbarCollapse = document.querySelector('.navbar-collapse');
                var bsCollapse = bootstrap.Collapse.getInstance(navbarCollapse);
                if (bsCollapse) bsCollapse.hide();
            }
        });

        document.querySelectorAll('.dropdown-toggle').forEach(function(element) {
            element.addEventListener('click', function(e) {
                if (window.innerWidth < 992) {
                    e.preventDefault();
                    e.stopPropagation();
                    this.nextElementSibling.classList.toggle('show');
                }
            });
        });

        document.querySelectorAll('.dropdown-item').forEach(function(element) {
            element.addEventListener('click', function() {
                var navbarCollapse = document.querySelector('.navbar-collapse');
                var bsCollapse = bootstrap.Collapse.getInstance(navbarCollapse);
                if (bsCollapse) bsCollapse.hide();
            });
        });

        const inputField = document.getElementById('studentIdSearch');
        inputField.addEventListener('focus', function() {
            var navbarCollapse = document.querySelector('.navbar-collapse');
            var bsCollapse = bootstrap.Collapse.getInstance(navbarCollapse);
            if (bsCollapse) bsCollapse.show();
        });

        inputField.addEventListener('blur', function() {
            setTimeout(() => {
                if (!inputField.matches(':focus')) {
                    var navbarCollapse = document.querySelector('.navbar-collapse');
                    var bsCollapse = bootstrap.Collapse.getInstance(navbarCollapse);
                    if (bsCollapse) bsCollapse.hide();
                }
            }, 200);
        });

        inputField.addEventListener('input', function() {
            this.value = this.value.replace(/[^0-9]/g, '');
        });
    });

    function populateDropdown() {
        fetch('https://opensheet.elk.sh/1EZtfvb0h9wYZbRFTGcm0KVPScnyu6B-boFG6aMpWEUo/ปีการศึกษา')
            .then(response => response.json())
            .then(data => {
                const dropdown = document.getElementById('semesterDropdown');
                data.forEach(item => {
                    const option = document.createElement('option');
                    option.value = item['ปีการศึกษา'];
                    option.text = item['ปีการศึกษา'];
                    dropdown.appendChild(option);
                });

                // Load data for the first semester by default
                loadElectricityData(data[0]['ปีการศึกษา']);
                loadWaterData(data[0]['ปีการศึกษา']);
            });
    }
  $(document).ready(function() {
    $("#footer-container").load("footer.html");
});
</script>
</body>
</html>
